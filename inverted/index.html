<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=yes, maximum-scale=1.0, minimum-scale=1.0">
<title>強化学習による倒立振子の制御実験</title>
<meta name="keywords" content="強化学習による倒立振子の制御実験">
<meta name="description" content="">
<link rel="stylesheet" href="style.css" type="text/css" media="screen">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ["\\(","\\)"]] } });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>
<meta http-equiv="X-UA-Compatible" CONTENT="IE=EmulateIE7" />
</head>

<body>
<div align="right"><a href="../index.php">&gt; &gt;ディペンダブルシステム論研究室ページへ</a></div>

<h2>強化学習による倒立振子の制御実験</h2>

<p>
学校の掃除の時間にホウキを逆さまにして指に乗せて遊んだことありませんか？指を動かしてどのくらい長い時間バランスを取れるかを競う遊びです．今回はこの遊びをコンピュータにやってもらいましょう．果たしてコンピュータはどのくらい長くバランスを取っていられるでしょうか？
</p>

<h3>倒立振子の運動方程式</h3>
<p>ホウキの遊びは倒立振子（とうりつしんし）と呼ばれる物理学の典型的なモデルです．ここでは倒立振子のシミュレーションを行うのに必要な運動方程式を紹介します．</p>

<img src="./images/invp.png">

<p>ホウキを棒，指を台車に変えて，図のような倒立振子の運動方程式を求めます．各物理量は次のようにします．</p>
<ul>
<li>$M$: 台車の質量．
<li>$m$: 棒の質量．
<li>$2l$: 棒の長さ．
<li>$g$: 重力加速度．
<li>$F$: 台車を押す力．
<li>$x(t)$: 台車の位置．
<li>$a(t)$: 地面に対する垂線と棒のなす角度．
</ul>
<p>これらを用いて運動方程式を作ると次のようになります．</p>
<div class="eq">
\begin{align}
& (M + m) \ddot{x}(t) + m l^2 \ddot{a}(t) \cos a(t) = F + m l \dot{a}(t)^2 \sin a(t) \\
& m l \ddot{x}(t) \cos a + m l^2 \ddot{a}(t) = m g l \sin a(t).
\end{align}
</div>
<p>これを $\ddot{x}(t)$ と $\ddot{a}(t)$ について解くと次の解が得られます．</p>
<div class="eq">
\begin{align}
& \ddot{x}(t) = \frac{F + l \dot{a}(t)^2 \sin a(t) - mg \sin a(t) \cos a(t)}{M + m \sin^2 a(t)} \\
& \ddot{a}(t) = \frac{(M+m) g \sin a(t) - (F + l \dot{a}(t)^2 \sin a(t)) \cos a(t)}{l (M + m \sin^2 a(t))}.
\end{align}
</div>
<p>台車の質量，棒の質量と長さ，重力加速度，台車を押す力に実際に数値を設定することで，コンピュータ上でシミュレーションすることができます．カーソルキーの左右で台車の右側／左側から力を加えます．</p>

<ul>
<li>プレイ（play）: 開始します．
<li>一時停止（pause）: 一時中断します．
<li>スロー（slow）: 動きを遅くします．
</ul>
<ul>
<li>時間（time）: 棒が倒れるまでの時間を表します．
<li>記録（record）: 今まで最も長く棒のバランスを取った時間です．
</ul>

<ul>
<li>$M=1$ [kg]: 台車の質量．
<li>$m=1$ [kg]: 棒の質量．
<li>$2l=1.6$ [m]: 棒の長さ．
<li>$g=9.8$ [m/sec$^2$]: 重力加速度．
<li>$F=10$ [N]: 台車を押す力．
</ul>

<iframe src="main2.html" name="vsB" frameborder="0" scrolling="no" width="100%" height="100%"></iframe>

<h3>倒立振子の制御</h3>

<p>コンピュータは倒立振子の制御をどのように行うのでしょうか？「制御」と聞くと難しいことを連想するかもしれませんが，実は原理は非常に単純です．皆さんがホウキでバランスを取るときのことを想像してください．バランスを取るときには恐らく，目で見たり指にかかる重さを感じることでホウキの状態（角度，速度，加速度）を計測して，それに合わせて指をどう動かしたら良いかを決定しているはずです．</p>
<p>コンピュータを使った自動制御もこの原理で行うことができます．つまり棒や台車の状態を計測して，右から押すのか左から押すのかという行動を決定します．この行動の決定がうまくいけば長時間にわたって棒のバランスを保つことができます．</p>
<p>さて問題は「行動をどうやって決めるか？」です．このうまくバランスを保つ行動を決める方法は大きく分けて二通りあります．ひとつは，先ほど求めた運動方程式から理論上最適な行動を導き出す方法です．これは，今考えている問題に対して理想的な制御方法が得られるため，半永久的に棒のバランスを保つことができますが，難しい数学を使う必要があったり色々大変だったりします．</p>
<p>もっと手軽に良い制御方法を導く方法として，今回はコンピュータ上での「学習」に注目します．学習と聞くとこれまた「難しそう・・・」と思うかもしれませんが，少し前にお話ししたように原理はとても単純なものです．学習による制御では，私たちは予（あらかじ）めコンピュータにどうやって行動したら良いか指示しません．その代わり，棒が倒れなかったら褒めてあげ，棒を倒したら叱ってやります．最初，コンピュータは人間でいう赤ちゃんの状態で，どうやって台車を動かして良いかわからないので，フラフラします．しかし，何度も棒を倒して叱られることで，叱られることを回避する行動，つまり棒のバランスを取るような行動をするようになります．このように，ある環境内で，現在の状態を観測し，取るべき行動の決定を学習することを<b>強化学習</b>といいます．</p>
<p>強化学習は具体的にいくつかの学習アルゴリズムを持ちますが，この倒立振子では Q 学習と呼ばれる学習アルゴリズムを使っています．Q 学習は数学的にはマルコフ決定過程と呼ばれる確率過程に基づいたアルゴリズムです．</p>
</div>

<ul>
<li>再生（play）: シミュレーションを開始します．
<li>一時停止（pause）: シミュレーションを一時中断します．
<li>早送り（fast）: シミュレーションを早めます．
<li>初期化（reset）: 全て初期値に戻します．
</ul>
<ul>
<li>エピソード数（episode）: 棒が倒れるまでのひとつの学習エピソードを何回繰り返したかを表します．
<li>時間（time）: 棒が倒れるまでの時間を表します．
<li>記録（record）: 今まで最も長く棒のバランスを取った時間です．
</ul>

<ul>
<li>$M=1$ [kg]: 台車の質量．
<li>$m=1$ [kg]: 棒の質量．
<li>$2l=1.6$ [m]: 棒の長さ．
<li>$g=9.8$ [m/sec$^2$]: 重力加速度．
<li>$F=10$ [N]: 台車を押す力．
</ul>

<iframe src="main.html" name="vsB" frameborder="0" scrolling="no" width="100%" height="100%"></iframe>

<h3>おわりに</h3>

<p>今回は非常に単純なアルゴリズムを持つ強化学習で倒立振子を制御することを目指しました．「叱る・褒める」という単純な学習ですが，これを繰り返すことで制御方法を学習できることがわかります．人間の脳も強化学習によって学習しているという学説もあり，ロボットやウェブなど多くの分野での応用が期待されています．最近では，深層学習（Deep Learning）と組み合わさって，画像の情報だけから様々なことを学習することができるようになっています．Q 学習や深層学習の応用に興味がある人は「<a href="https://www.google.co.jp/search?q=%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92+%E6%B7%B1%E5%B1%A4%E5%AD%A6%E7%BF%92+%E3%82%B2%E3%83%BC%E3%83%A0&oq=%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92+%E6%B7%B1%E5%B1%A4%E5%AD%A6%E7%BF%92+%E3%82%B2%E3%83%BC%E3%83%A0&aqs=chrome..69i57.415j0j7&sourceid=chrome&ie=UTF-8" target="_blank">こちら（Google検索）</a>」から詳しい情報を探してみてください．</p>

</body>

</html>
